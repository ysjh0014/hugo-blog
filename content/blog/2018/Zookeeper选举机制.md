---
title: "Zookeeper选举机制"
date: 2018-08-21 13:28:00
draft: false
---
选举机制

1.集群中半数以上机器存活，则集群可用，所以zookeeper集群适合安装在奇数台机器上

2.zookeeper集群虽然在配置文件中并没有指定master和slave,但是zookeeper在工作时，是有一个为leader,其他为follower,leader是通过内部的选举机制临时产生的

3.下边通过一个例子来说明整个选举的过程

假设有五台服务器组成的zookeeper集群，它们的id从1-5，同时它们都是最新启动的，也就是没有历史数据，在存放数据量这一点上，都是一样的,现在这些服务器依次启动

![](https://img-blog.csdn.net/20180821132536808?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lzXzIzMDAxNA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

1).服务器1启动，此时只有它一台服务器启动了，它发出去的报没有任何响应，所以它的选举状态一直是LOOKING状态

2).服务器2启动，它与最开始启动的服务器1进行通信，互相交换自己的选举结果，由于两者都没有历史数据，所以id值较大的服务器2胜出，但是由于没有达到超过半数以上的服务器都同意选举它(这个例子中的半数以上是3)，所以服务器1、2还是继续保持LOOKING状态

3).服务器3启动，根据前面的理论分析，服务器3成为服务器1、2、3中的老大,而与上面不同的是，此时有三台服务器选举了它，所以它成为了这次选举的leader

4).服务器4启动，根据前面的分析，理论上服务器4应该是服务器1、2、3、4中最大的，但是由于前面已经有半数以上的服务器选举了服务器3，所以它只能是follower

5).服务器5启动，同4一样是follower